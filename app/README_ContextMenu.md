# تكامل معالج الضغط مع قائمة النقر الأيمن في Windows

هذا الدليل يوضح كيفية تثبيت واستخدام تكامل معالج الضغط مع قائمة النقر الأيمن في نظام التشغيل Windows.

## المتطلبات

- نظام التشغيل Windows 7 أو أحدث
- صلاحيات المدير لتعديل سجل النظام (Registry)
- بناء المشروع بنجاح والتأكد من وجود ملف `app.exe` في مجلد `app/bin/Debug/`

## التثبيت

### الطريقة الأولى: استخدام ملف التثبيت التلقائي (موصى بها)

1. تأكد من بناء المشروع أولاً:

   ```
   cd app
   msbuild app.sln /p:Configuration=Debug
   ```

2. قم بتشغيل ملف التثبيت كمدير:

   ```
   النقر الأيمن على install_context_menu.bat → "تشغيل كمدير"
   ```

3. اتبع التعليمات التي تظهر على الشاشة

### الطريقة الثانية: التثبيت اليدوي

إذا لم تنجح الطريقة الأولى، يمكنك تثبيت التكامل يدوياً:

1. افتح محرر التسجيل (Registry Editor) كمدير
2. أضف المفاتيح المطلوبة يدوياً (راجع ملف `install_context_menu.bat` للمفاتيح المطلوبة)

## المزايا المتاحة

بعد التثبيت الناجح، ستحصل على الخيارات التالية:

### للملفات العادية

عند النقر الأيمن على أي ملف، ستجد خيار:

- **"ضغط الملف باستخدام معالج الضغط"** - يضغط الملف باستخدام خوارزمية Huffman

### للملفات المضغوطة

عند النقر الأيمن على ملفات `.huff` أو `.fs`، ستجد خيار:

- **"فك ضغط الملف"** - يفك ضغط الملف تلقائياً باستخدام الخوارزمية المناسبة

### للمجلدات

عند النقر الأيمن على أي مجلد، ستجد خيار:

- **"ضغط المجلد باستخدام معالج الضغط"** - يضغط جميع ملفات المجلد في أرشيف واحد

### في المساحة الفارغة

عند النقر الأيمن في مساحة فارغة داخل مجلد، ستجد خيار:

- **"فتح معالج الضغط"** - يفتح الواجهة الرئيسية للبرنامج

## كيفية الاستخدام

### ضغط الملفات

1. انقر الأيمن على الملف المراد ضغطه
2. اختر "ضغط الملف باستخدام معالج الضغط"
3. اختر ما إذا كنت تريد حماية الملف بكلمة سر أم لا
4. إذا اخترت الحماية، أدخل كلمة السر
5. انتظر حتى اكتمال عملية الضغط
6. سيتم إنشاء ملف مضغوط بنفس اسم الملف الأصلي مع امتداد `.huff`

### فك ضغط الملفات

1. انقر الأيمن على الملف المضغوط (`.huff` أو `.fs`)
2. اختر "فك ضغط الملف"
3. إذا كان الملف محمياً بكلمة سر، أدخل كلمة السر الصحيحة
4. انتظر حتى اكتمال عملية فك الضغط
5. سيتم إنشاء الملف الأصلي في نفس المجلد

### ضغط المجلدات

1. انقر الأيمن على المجلد المراد ضغطه
2. اختر "ضغط المجلد باستخدام معالج الضغط"
3. اختر ما إذا كنت تريد حماية الأرشيف بكلمة سر أم لا
4. إذا اخترت الحماية، أدخل كلمة السر
5. انتظر حتى اكتمال عملية الضغط
6. سيتم إنشاء ملف أرشيف بنفس اسم المجلد مع امتداد `.huff`

## الأمان

- **حماية كلمة السر**: يستخدم البرنامج تشفير AES-256 مع PBKDF2 لحماية الملفات
- **الأمان**: كلمات السر لا يتم حفظها، فقط تُستخدم لاشتقاق مفاتيح التشفير
- **القوة**: كل ملف يحصل على Salt و IV فريدين لأقصى أمان

## إلغاء التثبيت

لإزالة تكامل قائمة النقر الأيمن:

1. قم بتشغيل ملف `uninstall_context_menu.bat` كمدير
2. اتبع التعليمات التي تظهر على الشاشة
3. قد تحتاج إلى إعادة تشغيل File Explorer لرؤية التغييرات

## استكشاف الأخطاء

### المشكلة: لا تظهر خيارات الضغط في قائمة النقر الأيمن

**الحلول:**

1. تأكد من تشغيل ملف التثبيت كمدير
2. تأكد من وجود ملف `app.exe` في المسار الصحيح
3. أعد تشغيل File Explorer أو الكمبيوتر
4. تحقق من سجل النظام للتأكد من إضافة المفاتيح

### المشكلة: خطأ "الملف غير موجود"

**الحلول:**

1. تأكد من بناء المشروع بنجاح
2. تحقق من وجود ملف `app.exe` في `app/bin/Debug/`
3. أعد تشغيل ملف التثبيت

### المشكلة: رسالة خطأ "Access Denied"

**الحلول:**

1. تأكد من تشغيل ملف التثبيت كمدير
2. أغلق جميع نوافذ File Explorer
3. حاول التثبيت مرة أخرى

### المشكلة: لا يعمل الضغط أو فك الضغط

**الحلول:**

1. تأكد من أن الملف المستهدف غير مفتوح في برنامج آخر
2. تحقق من صلاحيات الكتابة في المجلد
3. تأكد من وجود مساحة كافية على القرص الصلب

## معلومات إضافية

### أنواع الملفات المدعومة

- **للضغط**: جميع أنواع الملفات
- **لفك الضغط**: `.huff` (Huffman) و `.fs` (Fano-Shannon)

### خوارزميات الضغط

- **الافتراضية**: Huffman (للضغط من قائمة النقر الأيمن)
- **المدعومة**: Huffman و Fano-Shannon (لفك الضغط)

### حجم الملفات

- لا توجد قيود على حجم الملفات نظرياً
- الأداء يعتمد على ذاكرة النظام المتاحة

## الدعم

إذا واجهت أي مشاكل:

1. تحقق من قسم "استكشاف الأخطاء" أعلاه
2. تأكد من أن نظامك يلبي المتطلبات
3. جرب إعادة تثبيت التكامل
4. تحقق من أن البرنامج يعمل بشكل طبيعي عند تشغيله مباشرة

---

**ملاحظة**: هذا التكامل يتطلب صلاحيات المدير لأنه يعدل سجل النظام (Windows Registry). تأكد من أنك تثق في هذا البرنامج قبل منحه هذه الصلاحيات.
